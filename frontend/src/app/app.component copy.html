<div style="padding: 16px">
  <h1>Web Log 查詢</h1>

  <div class="container" style="display: flex; align-items: end; gap: 16px">
    <textarea
      [(ngModel)]="userInput"
      rows="5"
      class="form-control"
      style="flex-grow: 1"
      placeholder="請輸入指令..."
    ></textarea>

    <!-- 按鈕區域 -->
    <div style="display: flex; flex-direction: column; align-items: center; gap: 8px">
      <button
        class="btn btn-primary mt-2"
        style="width: 100%; height: 28px;"
        (click)="sendInput()"
        [disabled]="loading"
      >
        default
        <span
          *ngIf="loading"
          class="spinner-border spinner-border-sm ms-2"
          role="status"
          aria-hidden="true"
        ></span>
      </button>

      <button
        class="btn btn-secondary mt-2"
        style="width: 100%; height: 28px;"
        (click)="queryLog()"
        [disabled]="loading"
      >
        DSPy流程
        <span
          *ngIf="loading"
          class="spinner-border spinner-border-sm ms-2"
          role="status"
          aria-hidden="true"
        ></span>
      </button>
    </div>
  </div>

  <div class="mt-3">
    <h5>回應：</h5>

    <!-- 顯示 loading indicator 或回應內容 -->
    <div *ngIf="loading" class="text-center">
      <span
        class="spinner-border spinner-border-sm"
        role="status"
        aria-hidden="true"
      ></span>
      請稍候，正在處理中...
    </div>

    <markdown *ngIf="!loading" [data]="agentResponse?.response"></markdown>
    <markdown *ngIf="!loading" [data]="queryLogResponse"></markdown>

    <!-- <h5>所有內容：</h5>
    <pre>{{ agentResponse?.all_contents | json }}</pre> -->
  </div>

  <div *ngIf="error" class="text-danger mt-3">
    {{ error }}
  </div>
</div>
